install.packages('rLakeAnalyzer')
install.packages('plyr')
install.packages('R2jags')
install.packages('R2WinBUGS')
library(R2jags)
install.packages('raster')
cite('raster')
library(raster)
cite(raster)
cite('raster')
citation('raster')
remove.packages('rLakeAnalyzer')
install.packages('rLakeAnalyzer')
library(rLakeAnalyzer)
?rLakeAnalyzer
?wrt.heat.map
?wtr.heat.map
Get the path for the package example file included
wtr.path <- system.file('extdata', 'Sparkling.daily.wtr', package="rLakeAnalyzer")
#Load data for example lake, Sparkilng Lake, Wisconsin.
sp.wtr = load.ts(wtr.path)
#Plot default figure
wtr.heat.map(sp.wtr)
#Change defaults supplied to filled.contour
wtr.heat.map(sp.wtr, zlim=c(0,15), plot.title="Sparkling Water Temp (C)")
Get the path for the package example file included
wtr.path <- system.file('extdata', 'Sparkling.daily.wtr', package="rLakeAnalyzer")
#Load data for example lake, Sparkilng Lake, Wisconsin.
sp.wtr = load.ts(wtr.path)
#Plot default figure
wtr.heat.map(sp.wtr)
#Change defaults supplied to filled.contour
wtr.heat.map(sp.wtr, zlim=c(0,15), plot.title="Sparkling Water Temp (C)")
wtr.heat.map(sp.wtr, zlim=c(0,15), plot.title="Sparkling Water Temp (C)")
wtr.heat.map(sp.wtr, zlim=c(0,25), plot.title="Sparkling Water Temp (C)")
rainbow(10)
colors = rainbow(ncol(sp.wtr))
wtr.path <- system.file('extdata', 'Sparkling.daily.wtr', package="rLakeAnalyzer")
library(rLakeAnalyzer)
wtr.path <- system.file('extdata', 'Sparkling.daily.wtr', package="rLakeAnalyzer")
sp.wtr = load.ts(wtr.path)
colors = rainbow(ncol(sp.wtr))
plot(sp.wtr[,1], sp.wtr[,1], type='l', col=colors[1])
plot(sp.wtr[,1], sp.wtr[,2], type='l', col=colors[1])
for i in 3:ncol(sp.wtr){
lines(sp.wtr[,1], sp.wtr[,i], type='l', col=colors[i]])
}
for i in 3:ncol(sp.wtr){
for( i in 3:ncol(sp.wtr)){
lines(sp.wtr[,1], sp.wtr[,i], type='l', col=colors[i]])
}
for( i in 3:ncol(sp.wtr)){
lines(sp.wtr[,1], sp.wtr[,i], type='l', col=colors[i]])
for( i in 3:ncol(sp.wtr)){
lines(sp.wtr[,1], sp.wtr[,i], type='l', col=colors[i])
}
wtr.path <- system.file('extdata', 'Sparkling.daily.wtr', package="rLakeAnalyzer")
wtr.path
update.packages
update.packages()
source('C:/Users/lawinslow/Desktop/colors.could.be.better.R', echo=TRUE)
217*.27
distance = seq(0,10,by=0.1)
source('D:/Dropbox/rLakeAnalyzer/rLakeAnalyzer/R/wtr.heatmap.layers.R', echo=TRUE)
prompt(wtr.heatmap.layers,'wtr.heatmap.layers.Rd')
getwd()
dates = seq(as.POSIXct('2010-01-01'), as.POSIXct('2011-01-01'), by='1 day')
dates
?Date
as.Date('2010-01-01')
as.Date('2010-01-01 10:00:00')
as.numeric(as.Date('2010-01-01'))
as.numeric(as.Date('2010-01-01'))/365
as.POSIXct('2010-01-01 10:00:00')
?POSIXct
as.numeric(as.POSIXct('2010-01-01 10:00:00'))
as.numeric(as.POSIXct('2010-01-01 10:00:00'))/365
as.numeric(as.POSIXct('2010-01-01 10:00:00'))/365/24/60
as.numeric(as.POSIXct('2010-01-01 10:00:00'))/365/24/60/60
?POSIXlt
as.POSIXlt('2010-01-01 10:00:00')
as.numeric(as.POSIXlt('2010-01-01 10:00:00'))
as.list(as.POSIXlt('2010-01-01 10:00:00'))
class(as.POSIXlt('2010-01-01 10:00:00')) = NULL
?class
class(as.POSIXlt('2010-01-01 10:00:00'))
class(list())
class(as.POSIXlt('2010-01-01 10:00:00')) = "list"
assign(as.POSIXlt('2010-01-01 10:00:00')) = "list"
?assign
as.POSIXlt('2010-01-01 10:00:00')
unclass(as.POSIXlt('2010-01-01 10:00:00'))
unclass(as.POSIXlt('2010-01-02 10:00:00'))
as.POSIXlt('2010-01-02 10:00:00')$year
as.POSIXlt('2010-06-01 10:00:00')$yday
as.POSIXlt('2010-06-01 10:00:00')$yday+1
as.POSIXlt('2010-01-01 10:00:00')$yday
dates = seq(as.POSIXct('2010-01-01'), as.POSIXct('2011-01-01'), by='1 day')
dates
?rnorm
test = data.frame(datetime=dates, blah=rnorm(length(dates)))
test
head(test)
ss = as.POSIXct('2010-06-21')
ss
test$datetime > ss
test$afterSS = test$datetime > ss
test$beforeSS = test$datetime < ss
head(test)
which(test$datetime > ss)
which(test$datetime < ss)
test$gasPrice = NA
head(test)
test = data.frame(datetime=dates, blah=rnorm(length(dates)))
ss = as.POSIXct('2010-06-21')
test$gasPrice = NA
head(test)
test[test$datetime > ss, ] = price.after.ss
test[test$datetime < ss, ] = price.before.ss
price.before.ss = 3.00
price.after.ss  = 4.00
test[test$datetime > ss, ] = price.after.ss
test[test$datetime < ss, ] = price.before.ss
testss
ss
test$gasPrice[test$datetime > ss] = price.after.ss
test$gasPrice[test$datetime < ss] = price.before.ss
test
plot(test$datetime, plot$gasPrice)
plot(test$datetime, test$gasPrice)
plot(test$datetime, test$gasPrice, xlim=c(0,5))
plot(test$datetime, test$gasPrice, ylim=c(0,5))
citation(rLakeAnalyzer)
citation('rLakeAnalyzer')
library(LakeMetabolizer)
library(data.table)
library(plyr)
data.path = 'D:/Dropbox/Work/Clean Buoy Data/Mendota'
doobs = load.ts(file.path(data.path, '2009','Mendota.doobs'))
wnd = load.ts(file.path(data.path, '2009','Mendota.wnd'))
wtr = load.ts(file.path(data.path, '2009','Mendota.wtr'))
par = load.ts(file.path(data.path, '2009','Mendota.par'))
#Scale wind to U10
U10 = wind.scale(wnd,2)
# Calculate z.mix
md = ts.meta.depths(wtr, seasonal=TRUE)
z.mix = md[,1:2]
names(z.mix)[2] = 'z.mix'
# Calculate DO - DOSat
dosat = o2.at.sat(wtr[,c('datetime', 'wtr_0')], altitude=260)
both = merge(dosat, doobs)
both$deltaSat = both$do - both$do.sat
deltaSat = both[,c('datetime','deltaSat')]
# Calculate dDO and dT
dDO = data.frame(datetime = doobs$datetime[1:(nrow(doobs)-1)],
dDO = diff(doobs$do))
#strip any attributes, make sure dt is in units of minutes
dt = data.frame(datetime = doobs$datetime[1:(nrow(doobs)-1)],
dt = as.numeric(diff(doobs$datetime, units="mins")))
all.data = merge(merge(merge(merge(merge(merge(dt,dDO), deltaSat), par), U10), wtr[,c('datetime', 'wtr_0')]), z.mix)
all.data = data.table(all.data[complete.cases(all.data),])
all.data = all.data[dt==1 & z.mix > 0,] #use only 1 minute data
cuts = c(0, 1, 3, 5, 10, 20, 100)
#  Parameters: do offset, then k600 (m/day) for each wind bin
start.par = c(0, rep(4,length(cuts)-1))
parameters = start.par
do.offset = params[1]
params = start.par
do.offset = params[1]
vals = params[2:length(params)]
k600 = vals[cut(all.data$wnd_10, cuts, right=FALSE)]
k.gas = k600.2.kGAS.base(k600, all.data$wtr_0, gas='O2')
inst_flux <- (k.gas*(all.data$dt/1440) * (all.data$deltaSat + do.offset)*-1) #(do.sat - do.obs)
all.data$noflux.do.diff <- all.data$dDO - inst_flux/all.data$z.mix
all.data[,day:=as.POSIXct(trunc(datetime, units='days'))]
tmp = ddply(all.data, 'day', function(df){sum(resid(lm(df$noflux.do.diff ~ df$par - 1))^2)})
tmp
tmp$V1
sum(tmp$V1)
(sum(resid(mod)^2))
mod <- lm(noflux.do.diff ~ all.data$par - 1)
mod <- lm(all.data$noflux.do.diff ~ all.data$par - 1)
(sum(resid(mod)^2))
sse = sum(tmp$V1)
sse
?optim
sqrt(0.09)
(0.09)^2
?globalVariables
library(devtools)
install_github(repo='EML','ropensci')
install.packages('RWordXML')
install_github(repo='RWordXML','duncantl')
install.packages('Rcompression')
install.packages('Rcompression', repos = "http://www.omegahat.org/R")
install.packages('Rcompression', repos = "http://www.omegahat.org/R", type='source')
install.packages('ROOXML', repos = "http://www.omegahat.org/R", type='source')
install.packages('ROOXML', repos = "http://www.omegahat.org/R")
install.packages('ROOXML', repos = "http://www.omegahat.org/R", type='source')
install.packages('ROOXML', repos = "http://www.omegahat.org/R", type='source')
install.packages('ROOXML', repos = "http://www.omegahat.org/R", type='source')
install.packages('ROOXML', repos = "http://www.omegahat.org/R", type='source')
install.packages('ROOXML', repos = "http://www.omegahat.org/R", type='source')
install.packages('ROOXML', repos = "http://www.omegahat.org/R", type='source')
install.packages('ROOXML', repos = "http://www.omegahat.org/R", type='source')
install.packages('ROOXML', repos = "http://www.omegahat.org/R", type='source')
install.packages('ROOXML', repos = "http://www.omegahat.org/R", type='source')
citation
citation(rLakeAnalyzer)
library(rLakeAnalyzer)
citation(rLakeAnalyzer)
citation('rLakeAnalyzer')
citation('LakeMetabolizer')
?download.file('http://www.wcc.nrcs.usda.gov/nwcc/rgrpt?station=20H13S&report=snowmonth_hist')
download.file('http://www.wcc.nrcs.usda.gov/nwcc/rgrpt?station=20H13S&report=snowmonth_hist', 'test.csv')
getwd()
setwd("D:/Dropbox/Work/CIDA-Viz/ca_snow/R")
read.csv('../sites.csv', as.is=TRUE)
sprintf
sites = read.csv('../sites.csv', as.is=TRUE)
sites$Station
sites$Station[1]
setwd("D:/Dropbox/Work/CIDA-Viz/ca_snow/R")
base_url = 'http://www.wcc.nrcs.usda.gov/nwcc/rgrpt?station=%s&report=snowmonth_hist'
sites = read.csv('../sites.csv', as.is=TRUE)
for(i in 1:nrow(sites)){
url = sprintf(base_url, sites$Station[i])
fname = print0('../data_raw/', sites$Station[1], '.csv')
}
base_url = 'http://www.wcc.nrcs.usda.gov/nwcc/rgrpt?station=%s&report=snowmonth_hist'
sites = read.csv('../sites.csv', as.is=TRUE)
for(i in 1:nrow(sites)){
url = sprintf(base_url, sites$Station[i])
fname = paste0('../data_raw/', sites$Station[1], '.csv')
download.file(url, fname)
}
?close
close()
file.close()
